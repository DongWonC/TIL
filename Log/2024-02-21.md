# 오늘 공부
# Python
## 05장 파이썬 날개 달기
### 05-7 외부 라이브러리
#### sympy
##### sympy 사용해 보기

시윤이는 가진 돈의 2/5로 학용품을 샀다고 한다. 이때 학용품을 사는 데 쓴 돈이 1,760원이라면 남은 돈은 어떻게 구하면 될까?

이 문제는 연습장과 연필만 있으면 쉽게 구할 수 있는 일차방정식 문제이다. 파이썬으로는 다음처럼 `sympy`를 사용하면 **방정식을 쉽게 풀 수 있다**. 먼저 다음과 같이 `ractions` 모듈과 `sympy` 모듈이 필요하다.

```Python
from fractions import Faction
import sympy
```

시윤이가 가진 돈을 x라고 하면 sympy 모듈을 사용하여 다음과 같이 표현할 수 있다.

```Python
x = sympy.symbols("x")
```

`sympy.symbols()`는 x처럼 **방정식에 사용하는 미지수를 나타내는 기호를 생성할 때 사용한다.**

###### 여러 개의 기호 사용하기
x, y 2개의 미지수가 필요하다면 다음처럼 표현할 수 있다.

```Python
x, y = sympy.symbols('x y')
```

시윤이가 가진 돈의 2/5는 1,760원, 즉 일차방정식 x \* (2/5) = 1760이므로 이를 코드로 표현하면 다음과 같다.

```Python
f = sympy.Eq(x*Fraction('2/5'), 1760)
```

`sympy.Eq(a, b)`는 a와 b가 같다는 방정식이다. 여기서 사용한 Fraction은 유리수를 표현할 때 사용하는 표준 라이브러리로, 2/5를 정확하게 계산하고자 사용했다.

>**fractions.Fraction으로 유리수 연산하기**
>파이썬에서 유리수 연산을 정확하게 하려면 fractions.Fraction을 사용해야 한다.
```Python
from fractions import Fraction
```
>
>유리수는 다음처럼 `Fraction(분자, 분모)` 형태로 만들 수 있다.
```Python
a = Fraction(1, 5)
a
# Fraction(1, 5)
```
>
>또는 다음과 같이 `Fraction('분자 / 분모')`처럼 문자열로 만들 수도 있다.
```Python
a = Fraction('1/5')
a
# Fraction(1, 5)
```

f라는 방정식을 세웠으므로 `sympy.solve(f)`로 x에 해당하는 값을 구할 수 있다.
```Python
result = sympy.solve(f)
result
# [4400]
```

방정식의 해는 여러 개일 수 있으므로 solve() 함수는 결괏값으로 리스트를 리턴한다. 결과를 보면 시윤이가 원래 가진 돈이 4,400원이라는 것을 알 수 있다. 따라서 남은 돈은 다음처럼 가진 돈에서 1,760원을 빼면 된다.
```Python
remains = result[0] - 1760
remains
# 2640
```

지금까지 내용을 종합한 풀이는 다음과 같다.
```Python
from fractions import Fraction
import sympy

# 가지고 있는 돈을 x라고 하자.
x = sympy.symbols('x')

# 가지고 있던 돈의 2/5가 1760원이므로 방정식은 x * (2/5) = 1760 이다.
f = sympy.Eq(x*Fraction('2/5'), 1760)

# 방정식을 만족하는 값(result)을 구한다.
result = sympy.solve(f)    # 결괏값은 리스트

# 남은 돈은 다음과 같이 가지고 있던 돈에서 1760원을 빼면 된다.
remains = result[0] - 1760

print("남은 돈은 {}원 입니다.".format(remains))
```

프로그램을 실행한 결과는 다음과 같다.

```
남은 돈은 2640원입니다.
```

##### sympy 활용
x<sup>2</sup> = 1과 같은 2차 방정식의 해를 구해 보자.
```Python
import sympy
x = sympy.symbols("x")
f = sympy.Eq(x**2, 1)
sympy.solve(f)
#[-1, 1]
```

또한 다음과 같은 연립방정식의 해도 구할 수 있다.
```
x + y = 10
x - y = 4
```

```Python
import sympy
x, y = sympy.symbols('x y')
f1 = sympy.Eq(x+y, 10)
f2 = sympy.Eq(x-y, 4)
sympy.solve([f1, f2])
{x : 7, y : 3}
```

미지수가 2개 이상이라면 결괏값이 리스트가 아닌 딕셔너리라는 것에 주의하자.
## 06장 파이썬 프로그래밍, 어떻게 시작해야 할까?
### 06-1 내가 프로그램을 만들 수 있을까?
다른 사람들이 만든 프로그램을 자세히 들여다보고 분석하는 데서 시작해 보자. 그러다 보면 다른 사람들의 생각도 읽을 수 있고, 거기에 더해 뭔가 새로운 아이디어가 떠오를 수도 있다.

**프로그램을 만들려면 가장 먼저 '입력'과 '출력'을 생각하라.**

가령 구구단 프로그램 중 2단을 만든다면 2를 입력값으로 주었을 때 어덯게 출력되어야 할지 생각해 보라고 했다.

- 함수 이름은? gugu로 짓자
- 입력받는 값은? 2
- 출력하는 값은? 2단(2, 4, 6, 8, ..., 18)
- 결과는 어떤 형태로 저장하지? 연속된 자료형이므로 리스트!

1. 먼저 에디터를 열고 다음과 같이 입력한다. gugu라는 함수에 2를 입력값으로 주면 result라는 변수에 결괏값을 넣으라는 뜻이다.
```Python
result = gugu(2)
```

2. 이제 결괏값을 어떤 형태로 받을 것인지 고민해 보자. 2단이므로 결괏값은 2, 4, 6, ..., 18까지 나올 것이다. 이런 종류의 데이터는 리스트 자료형이 적합하다. 따라서 `result = [2, 4, 6, 8, 10, 12, 14, 16, 18]` 같은 결과를 얻어야겠다는 생각을 먼저 하고 프로그래밍을 시작하는 태도가 필요하다. 이런 식으로 머릿속에 그림이 그려지기 시작하면 의외로 생각이 가볍게 좁혀지는 것을 느낄 수 있을 것이다.

3. 어떻게 만들지 생각해 봤으므로 1번에서 입력한 문장은 지우고 진짜 프로그램을 짜 보자. 일단 이름을 gugu라고 지은 함수를 다음과 같이 만든다.
```Python
def gugu(n):
	print(n)
```

위와 같이 함수를 만들고 gugu(2)를 실행하면 2를 출력한다. 즉, 입력값으로 2가 잘 들어오는지 확인하는 것이다.

4. 이제 결괏값을 담을 리스트를 하나 생성하자. 앞에서 작성한 print(n)은 입력이 잘되는지를 확인하기 위한 것이었으므로 지워도 좋다.
```Python
def gugu(n):
	result = []
```

5. 다음으로 result에 2, 4, 6, ..., 18을 어떻게 넣어야 할지 생각해 보자. 다음과 같이 리스트에 요소를 추가하는 append 함수를 사용하기로 결정했다.
```Python
def gugu(n):
	result = []
	result.append(n*1)
	result.append(n*2)
	result.append(n*3)
	result.append(n*4)
	result.append(n*5)
	result.append(n*6)
	result.append(n*7)
	result.append(n*8)
	result.append(n*9)
	return result

print(gugu(2))
# [2, 4, 6, 8, 10, 12, 14, 16, 18]
```

6. 그런데 앞에서 만든 함수는 반복이 너무 많다. 가만히 보면 `result.append(n*x)`의 x 위치에 1부터 9까지 숫자만 다르게 들어가 있다는것을 알 수 있다. 똑같은 일을 반복할 때는 '반복문'을 사용한다고 했다. 그렇다면 1부터 9까지 출력해 주는 반복문을 만들면 되지 않을까? 대화형 인터프리터를 열고 다음과 같이 테스트해 보았다.
```Python
while i < 10:
	print(i)
	i = i + 1
```

매우 만족스러운 결과이다. 이제 위 소스 코드를 gugu 함수에 적용해 보자.

7. 이상의 생각을 바탕으로 완성한 gugu 함수는 다음과 같다.
```Python
def gugu(n):
	result = []
	i = 1
	while i < 10:
		result.append(n * i)
		i = i + 1
	return result

print(gugu(2))
# [2, 4, 6, 8, 10, 12, 14, 16, 18]
```

복잡한 함수를 만들 때는 이렇게 구체적이고 단게적으로 접근하는 방식이 많은 도움이 된다. 프로그래밍을 할 때는 매우 구체적으로 접근해야 머리가 덜 아프다는 것을 기억하자.

#### 06-2 3과 5의 배수를 모두 더하기
다음 문제를 어떻게 풀면 좋을지 생각해 보자.
```
10 미만의 자연수에서 3과 5의 배수를 구하면 3, 5, 6, 9이다. 이들의 총합은 23이다.
1,000 미만의 자연수에서 3의 배수와 5의 배수의 총합을 구하라.
```
- 입력받는 값은? 1부터 999까지(1000 미만의 자연수)
- 출력하는 값은? 3의 배수와 5의 배수의 총합
- 생각해 볼 것은?
	1. 3의 배수와 5의 배수는 어떻게 찾지?
	2. 3의 배수와 5의 배수가 겹칠 때는 어떻게 하지?

이 문제를 풀기 위한 중요 포인트는 2가지다. 1가지는 1,000 미만의 자연수를 구하는 방법이고 또 다른 1가지는 3과 5의 배수를 구하는 것이다.

1. 먼저 1,000 미만의 자연수는 어떻게 구할 수 있을지 생각해 보자. 다음과 같이 변수에 초깃값 1을 준 후 루프를 돌리면 1씩 증가시켜서 999까지 진행하는 방법이 가장 일반적인 방법이다.
```Python
n = 1
while n < 1000:
	print(n)
	n += 1
```

또는 다음과 같이 좀 더 파이썬다운 range 함수를 사용할 수도 있다.
```Python
for n in range(1, 1000):
	print(n)
```

2가지 예 모두 실행하면 1부터 999까지 출력하는 것을 확인할 수 있다.

2. 1,000까지의 자연수를 차례로 구하는 방법을 알았으므로 3과 5의 배수를 구하는 방법을 알아보자. 1,000미만의 자연수 중 3의 배수는 다음과 같이 증가할 것이다.
```
3, 6, 9, 12, 15, 18, ..., 999
```

1부터 1,000까지의 수 중 3으로 나누었을 때 나누어떨어지는 경우, 즉 2으로 나누었을 때 나머지가 0인 경우가 바로 3의 배수이다. 따라서 다음과 같이 % 연산자를 사용하면 3의 배수를 쉽게 찾을 수 있다.
```Python
for n in range(1, 1000):
	if n % 3 == 0:
		print(n)
```

그렇다면 5의 배수는 `n % 5`가 0이 되는 수로 구할 수 있을 것이다.

3. 이러한 내용을 바탕으로 만든 최종 풀이는 다음과 같다.
```Python
result = 0
for n in range(1, 1000):
	if n % 3 == 0 or n % 5 == 0:
		result += n
print(result)
```

3과 5의 배수에 해당하는 수를 result 변수에 계속해서 더해 주었다.

이 문제에는 1가지 함정이 있는데, 3으로도 5로도 나누어지는 15와 같은 수가 중복으로 더해질 수 있다는 점이다. 따라서 15와 같이 3의 배수도 되고 5의 배수도 되는 값을 중복으로 더하지 않도록 or 연산자를 사용했다.

다음 예는 15와 같은 수를 이중으로 더하여 잘못된 결과를 출력하는 풀이다.

```Python
result = 0
for n in range(1, 1000):
	if n % 3 == 0:
		result += n
	if n % 5 == 0:
		result += n

print(result)
```
#### 06-3 게시판 페이징하기
A 씨는 게시판 프로그램을 작성하고 있다. 그런데 게시물의 총 개수와 한 페이지에 보여 줄 게시물 수를 입력으로 주었을 때 총 페이지 수를 출력하는 프로그램이 필요하다고 한다.

> 이렇게 게시판의 페이지 수를 구하는 것을 '페이징'이라고 부른다.

- 함수 이름은? get_total_page
- 입력받는 값은? 게시물의 총 개수(m), 한 페이지에 보여 줄 게시물 수(n)
- 출력하는 값은? 총 페이지 수

게시물의 총 개수가 5이고 한 페이지에서 보여 줄 게시물 수가 10이면 총 페이지 수는 당연히 1이 된다. 만약 게시물의 총 개수가 15이고 한 페이지에서 보여 줄 게시물 수가 10이라면 총 페이지 수는 2가 될 것이다.

| 게시물의 총 개수(m) | 페이지당 보여줄 게시물 수(n) | 총 페이지 수 |
| ---- | ---- | ---- |
| 5 | 10 | 1 |
| 15 | 10 | 2 |
| 25 | 10 | 3 |
| 30 | 10 | 3 |
실제 업무에서 사용하는 페이징 기술은 훨씬 복잡한데 여기에서는 그중 가장 간단한 총 페이지 수를 구하는 방법에 대해서만 알아본다.

1. 다음과 같이 총 게시물 개수 (m)를 한 페이지에 보여 줄 게시물 수(n)로 나누고 1을 더하면 총 페이지 수를 얻을 수 있다.
```
총 페이지 수 = (총 게시물 개수 / 한 페이지당 보여 줄 개수) + 1
```

2. 이러한 공식을 적용했을 경우 총 페이지 수가 표의 값처럼 구해지는지 확인해 보자.
```Python
def get_total_page(m, n):
	return m // n + 1    # m을 n으로 나눌 때 소수점 아래 자리를 버리기 위해 // 연산자 사용

print(get_total_page(5, 10))    # 1 출력
print(get_total_page(15, 10))    # 2 출력
print(get_total_page(25, 10))    # 3 출력
print(get_total_page(30, 10))    # 4 출력
```

첫 번째, 두 번째, 세 번째 케이스는 공식에 맞게 결과가 출력된다. 하지만 네 번째 케이스는 게시물의 총 개수가 30이고 한 페이지에 보여 줄 개수가 10인데 4가 출력되어 실패해 버렸다. 총 개수가 30이고 한 페이지에 보여 줄 개수가 10이라면 당연히 총 페이지 수는 3이 되어야 한다.

3. 실패 케이스는 총 게시물 수와 한 페이지에 보여 줄 게시물 수를 나눈 나머지 값이 0이 될 때 발생한다는 것을 유추할 수 있을 것이다. 이 실패 케이스를 해결하려면 다음과 같이 코드를 변경해야 한다.
```python
def get_total_page(m, n):
	if m % n == 0:
		return m // n
	else:
	return m // n + 1

print(get_total_page(5, 10))
print(get_total_page(15, 10))
print(get_total_page(25, 10))
print(get_total_page(30, 10))    # 3 출력
```

나누었을 때 나머지가 0인 경우는 나누기의 몫만 리턴하고 이외의 경우에는 1을 더하여 리턴하도록 변경했다.
#### 06-4 간단한 메모장 만들기
원하는 메모를 파일에 저장하고 추가 및 조회가 가능한 간단한 메모장을 만들어 보자.

- 필요한 기능은? 메모 추가하기, 메모 조회하기
- 입력받는 값은? 메모 내용, 프로그램 실행 옵션
- 출력하는 값은? memo.txt

가장 먼저 해야 할 일은 메모를 추가하는 것이다. 다음 명령을 실행했을 때 메모를 추가할 수 있도록 만들어 보자.

```Python
python memo.py -a "Life is too short"
```

memo.py는 우리가 작성할 파이썬 프로그램 이름이다. -a는 이 프로그램의 실행 옵션이고 "Life is too short"는 추가할 메모 내용이 된다.

1. 먼저 다음과 같이 입력으로 받은 옵션과 메모를 출력하는 코드를 에디터로 작성해 보자.
```Python
import sys

option = sys.argv[1]
memo = sys.argv[2]

print(option)
print(memo)
```

sys.argv는 프로그램을 실행할 때 입력된 값을 읽어 들일 수 있는 파이썬 라이브러리이다. sys.argv\[0]은 입력 받은 값 중에서 파이썬 프로그램 이름인 memo.py이므로 우리가 만들려는 기능에는 필요 없는 값이다. 그리고 순서대로 sys.argv\[1]은 프로그램 실행 옵션이 되고 sys.argv\[2]는 메모 내용이 된다.

2. memo.py를 작성했다면 다음 명령을 수행해 보자.

> memo.py는 `C:\doit` 디렉터리에 저장한다.

```
C:\doit>python memo.py -a "Life is too short"
-a
Life is too short
```

입력으로 전달한 옵션과 메모 내용이 그대로 출력되는 것을 확인할 수 있다.

3. 이제 입력으로 받은 메모를 파일에 쓰도록 코드를 변경해 보자.
```Python
import sys

option = sys.argv[1]

if option == '-a':
	memo = sys.argv[2]
	f = open('memo.txt', 'a')
	f.write(memo)
	f.write('\n')
	f.close()
```

옵션이 -a인 경우에만 memo 값을 읽어 memo.txt에 그 값을 쓰도록 코드를 작성했다. 여기에서 메모는 항상 새로운 내용이 작성되는 것이 아니라 한 줄씩 추가되어야 하므로 파일 열기 모드를 a로 했다. 그리고 메모를 추가할 때마다 다음 줄에 저장되도록 줄바꿈 문자(\\n)도 추가로 파일에 쓰게 했다.

4. 이제 다음과 같은 명령을 수행해 보자.

```
C:\doit>python memo.py -a "Life is too short"
C:\doit>python memo.py -a "You need python"
```

그리고 파일에 정상적으로 메모가 기입되었는지 다음과 같이 확인해 보자.

```
C:\doit>type memo.txt
Life is too short
You need python
```

추가한 메모가 정상적으로 저장된 것을 볼 수 있다.

이제 메모 출력을 위해 다음과 같이 코드를 변경해 보자.
```Python
import sys

option = sys.argv[1]

if option == '-a':
	memo =sys.argv[2]
	f = open('memo.txt', 'a')
	f.write(memo)
	f.write('\n')
elif option == '-v':
	f = open('memo.txt')
	memo = f.read()
	f.close()
	print(memo)
```

옵션으로 -v가 들어온 경우 memo.txt를 읽어서 출력한다.

6. 코드를 수정한 후 다음과 같은 명령을 수행해 보자.
```
C:\doit>python memo.py -v
Life is too short
You need python
```

입력한 메모가 그대로 출력되는 것을 확인할 수 있다.

#### 06-5 탭 문자를 공백 문자 4개로 바꾸기
이번에는 문서 파일을 읽어서 그 문서 파일 안에 있는 탭 문자(Tab)를 공백 문자(Space) 4개로 바꾸어 주는 스크립트를 작성해 보자.

- 필요한 기능은? 문서 파일 읽어 들이기, 문자열 변경하기
- 입력받는 값은? 택을 포함한 문서 파일
- 출력하는 값은? 탭이 공백으로 수정된 문서 파일

다음과 같은 형식으로 프로그램이 수행되도록 만들 것이다.
```
python tabto4.py src dst
```

1. 먼저 다음과 같이 tabto4.py 파일을 작성해 보자.

```Python
import sys

src = sys.argv[1]
dst = sys.argv[2]

print(src)
print(dst)
```

sys.argv를 사용하여 입력값을 확인하도록 만든 코드이다.

2. 다음과 같이 수행했을 때 입력값이 정상적으로 출력되는지 확인해 보자.

```
C:\doit>python tabto4.py a.txt b.txt
a.txt
b.txt
```

입력으로 전달한 a.txt와 b.txt가 정상적으로 출력되는 것을 확인할 수 있다.

3. 테스트를 위한 원본 파일(탭을 포함하는 파일)인 a.txt를 다음과 같이 작성한다. 각 단어는 탭(\\t) 문자로 분리되도록 입력해야 한다.

```
Life    is    too    short
You    need     python
```

4. 이제 탭 문자를 포함한 a.txt를 읽어 탭을 공백 4개로 변환할 수 있도록 코드를 수정해 보자.

```Python
import sys

src = sys.argv[1]
dst = sys.argv[2]

f = open(src)
tab_content = f.read()
f.close()

space_content = tab_content.replace("\t", " "*4)
print(space_content)
```

src에 해당되는 입력 파일을 읽어서 그 내용을 tab_content라는 변수에 저장한 후 문자열의 replace 함수를 사용해 탭(`\t`)을 4개의 공백으로 변경하도록 코드를 수정했다.

5. 이제 다음과 같은 명령을 수행해 보자.
```python
C:\doit>python tabto4.py a.txt b.txt
```

탭 문자가 공백 4개로 변경되어 출력될 것이다. 하지만 탭과 공백의 차이점을 눈으로 알 수는 없으므로 탭이 정상적으로 공백으로 변경되었는지 확인하기 어렵다.

6. 이제 변경된 내용을 b.txt에 저장할 수 있도록 다음과 같이 프로그램을 변경해 보자.
```Python
import sys

src = sys.argv[1]
dst = sys.argv[2]

f = open(src)
tab_content = f.read()
f.close()

space_content = tab_content.replace("\t", " "*4)

f = open(dst, 'w')
f.write(space_content)
f.close()
```

b.txt가 `C:\doit` 디렉터리에 생성된다. 에디터로 b.txt를 열어 탭이 4개의 공백 문자로 변경되었는지 확인해보자. 프로그램을 작성할 때 사용하는 에디터는 대부분 탭과 공백 문자를 다르게 표시하므로 눈으로 확인할 수 있다.


